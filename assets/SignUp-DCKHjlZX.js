import{_ as F,r as a,c as O,w as k,o as G,a as M,b as t,k as K,u as i,C as L,m as B,v as E,n as l,t as U,A as T,d as V,g,p as Q,h as D,i as _,I as S,j as $,q as W}from"./index-Nl0riu4T.js";import{a as X}from"./add_img-CmauYyjt.js";const Y={class:"form_image"},Z={class:"form_input"},ee={class:"form_input"},te={class:"form_input"},ae={class:"form_input"},le=["type"],ue={class:"form_input"},se=["type"],ie={class:"form_input"},ne=["disabled"],oe={key:1,class:"loadBtn",type:"button"},ve={__name:"SignUp",setup(re){const c=$("theme"),N=$("urlAdressAuth"),j=W(),p=a(""),h=a(""),v=a(""),r=a(""),m=a(""),f=a(!1),b=a(!1),w=a(null),I=a([]),d=a({validate:!1,text:"Имя пользователя уже существует"}),n=a({validate:!1,text:"Электронная почта уже зарегистрирована"}),A=a(!1),y=a({validate:!1,text:"Пароль должен быть боле 8 символов"}),x=a({validate:!1,text:"Не менее 11 символов в электронной почты"}),o=a(!0),H=O(()=>I.value.filter(u=>u.user_name===h.value)),P=O(()=>I.value.filter(u=>u.user_email===v.value)),R=async()=>{try{const u=await D.get(N);I.value=u.data}catch(u){console.log(u)}},q=()=>{f.value=!f.value},z=()=>{b.value=!b.value};function C(){let u=Math.floor(1e3+Math.random()*9e3);if(I.value.filter(s=>s.user_id===u).length>0){C();return}w.value=u}const J=async()=>{if(o.value=!1,w.value===null&&C(),p.value.length<20){A.value=!0,o.value=!0;return}if(h.value.length<3){d.value.text="Минимум 3 символа в имени !",d.value.validate=!0,o.value=!0;return}if(v.value.length<10){n.value.text="Не менее 11 символов в электронной почты",n.value.validate=!0,o.value=!0;return}else if(v.value.slice(-9)!=="gmail.com"){n.value.text="E-mail должен оканчиваться на gmail.com",n.value.validate=!0,o.value=!0;return}if(d.value.validate===!0||n.value.validate===!0){o.value=!0;return}if(r.value.length<8){y.value.text="Пароль должен быть боле 8 символов",y.value.validate=!0,o.value=!0;return}if(m.value!==r.value){x.value.text="Пароли не совпадают",x.value.validate=!0,o.value=!0;return}try{const u=await D.post(N,{user_logo:p.value,user_name:h.value,user_email:v.value,password:r.value,user_id:w.value,biography:""}),e={name:h.value,email:v.value,password:r.value};localStorage.setItem("UserId",w.value),localStorage.setItem("AuthData",JSON.stringify(e)),o.value=!0,p.value="",h.value="",v.value="",r.value="",m.value="",w.value=null,j.push("/posts")}catch(u){console.log(u)}};return k(()=>{H.value.length>0?(d.value.text="Имя пользователя уже существует",d.value.validate=!0):d.value.validate=!1}),k(()=>{P.value.length>0?(n.value.text="Электронная почта уже зарегистрирована",n.value.validate=!0):n.value.validate=!1}),k(()=>{p.value.length>20&&(A.value=!1)}),k(()=>{r.value.length&&(y.value.validate=!1)}),k(()=>{m.value.length&&(x.value.validate=!1)}),G(()=>{R(),C()}),(u,e)=>(_(),M("div",null,[t("form",{onSubmit:e[7]||(e[7]=Q(s=>J(),["prevent"])),id:"singUp_form"},[t("div",Y,[K(L,{src:p.value||i(X)},null,8,["src"])]),t("div",Z,[B(t("input",{type:"text",class:l(i(c)?"themeBgwhite input_light":"themeBgblack input_night"),placeholder:"Введите ссылку аватара","onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s)},null,2),[[E,p.value]]),t("label",{class:l({label_validate:A.value})},"Ссылка должна быть более 20 символов",2)]),t("div",ee,[B(t("input",{type:"text",class:l(i(c)?"themeBgwhite input_light":"themeBgblack input_night"),placeholder:"Создайте имя пользователя","onUpdate:modelValue":e[1]||(e[1]=s=>h.value=s)},null,2),[[E,h.value]]),t("label",{class:l({label_validate:d.value.validate})},U(d.value.text),3)]),t("div",te,[B(t("input",{type:"email",class:l(i(c)?"themeBgwhite input_light":"themeBgblack input_night"),placeholder:"Введите почту","onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s)},null,2),[[E,v.value]]),t("label",{class:l({label_validate:n.value.validate})},U(n.value.text),3)]),t("div",ae,[B(t("input",{type:f.value?"text":"password",class:l(i(c)?"themeBgwhite input_light":"themeBgblack input_night"),placeholder:"Создайте пароль","onUpdate:modelValue":e[3]||(e[3]=s=>r.value=s)},null,10,le),[[T,r.value]]),t("label",{class:l({label_validate:y.value.validate})},U(y.value.text),3),t("button",{type:"button",class:"input_button",onClick:e[4]||(e[4]=s=>q())},[f.value?(_(),V(i(S),{key:0,icon:"ci:show",width:"22",height:"22",class:l(i(c)?"input_icon_light":"input_icon_night")},null,8,["class"])):g("",!0),f.value?g("",!0):(_(),V(i(S),{key:1,icon:"ci:hide",width:"22",height:"22",class:l(i(c)?"input_icon_light":"input_icon_night")},null,8,["class"]))])]),t("div",ue,[B(t("input",{type:b.value?"text":"password",class:l(i(c)?"themeBgwhite input_light":"themeBgblack input_night"),placeholder:"Повторите пароль","onUpdate:modelValue":e[5]||(e[5]=s=>m.value=s)},null,10,se),[[T,m.value]]),t("label",{class:l({label_validate:x.value.validate})},U(x.value.text),3),t("button",{type:"button",class:"input_button",onClick:e[6]||(e[6]=s=>z())},[b.value?(_(),V(i(S),{key:0,icon:"ci:show",width:"22",height:"22",class:l(i(c)?"input_icon_light":"input_icon_night")},null,8,["class"])):g("",!0),b.value?g("",!0):(_(),V(i(S),{key:1,icon:"ci:hide",width:"22",height:"22",class:l(i(c)?"input_icon_light":"input_icon_night")},null,8,["class"]))])]),t("div",ie,[o.value?(_(),M("input",{key:0,type:"submit",value:"Зарегистрироваться",disabled:!p.value||!h.value||!v.value||!r.value||!m.value||d.value.validate||n.value.validate,class:l({"disabled-input":!p.value||!h.value||!v.value||!r.value||!m.value||d.value.validate||n.value.validate})},null,10,ne)):g("",!0),o.value?g("",!0):(_(),M("button",oe,e[8]||(e[8]=[t("div",{class:"loader"},null,-1)])))])],32)]))}},pe=F(ve,[["__scopeId","data-v-40359b32"]]);export{pe as default};
