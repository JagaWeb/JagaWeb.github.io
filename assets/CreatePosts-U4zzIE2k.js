import{r,o as D,a as h,e as a,n as i,u as d,k as P,C as T,m as _,v as f,t as U,f as k,p as N,g as y,h as b,q as j,j as m}from"./index-BI-kc5eB.js";import{a as R}from"./add_img-CmauYyjt.js";const q={class:"createpost_container"},z={class:"con_img"},E={class:"input-container"},F={class:"input-container"},G={class:"textarea-container"},H={class:"input-container"},Y=["disabled"],J={key:1,class:"loadBtn",type:"button"},Q={__name:"CreatePosts",setup(K){const w=j(),c=m("theme"),S=m("urlAdressAuth"),B=m("urlAdressPosts"),I=m("user_Id"),l=r(""),o=r(""),n=r(""),u=r(!0),p=r([]),v=r(null),$=async t=>{try{const e=await y.get(`${S}?user_id=${t}`);p.value=e.data[0]}catch(e){console.log(e)}},M=()=>{const t=new Date;let e=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),g=t.getFullYear(),V=String(t.getHours()).padStart(2,"0"),C=String(t.getMinutes()).padStart(2,"0");return`${e}.${s}.${g} ${V}:${C}`},x=async()=>{let t=Math.floor(1e4+Math.random()*9e4);if((await y.get(B)).data.filter(g=>g.image_id===t).length>0){x();return}v.value=t},A=async()=>{u.value=!1;try{const t=await y.post(B,{user_id:p.value.user_id,image:l.value,title:o.value,description:n.value,like:0,date:M(),user_logo:p.value.user_logo,user_name:p.value.user_name,image_id:v.value});l.value="",o.value="",n.value="",v.value=null,u.value=!0,w.push("/posts")}catch(t){console.log(t),u.value=!0}};return D(()=>{$(I),x()}),(t,e)=>(b(),h("div",q,[a("div",z,[a("div",{class:i(["div_img",d(c)?"themeBgwhite":"themeBgblack"])},[P(T,{src:l.value||d(R),class:"border-style"},null,8,["src"])],2)]),a("form",{onSubmit:e[3]||(e[3]=N(s=>A(),["prevent"])),class:"add-form"},[a("div",E,[_(a("input",{type:"text",class:i(d(c)?"themeBgwhite input_light":"themeBgblack input_night"),placeholder:"Введите ссылку картинки","onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s)},null,2),[[f,l.value]])]),a("div",F,[_(a("input",{type:"text",class:i(d(c)?"themeBgwhite input_light":"themeBgblack input_night"),maxlength:"40",placeholder:"Введите названия поста","onUpdate:modelValue":e[1]||(e[1]=s=>o.value=s)},null,2),[[f,o.value]])]),a("div",G,[_(a("textarea",{class:i(d(c)?"themeBgwhite input_light":"themeBgblack input_night"),maxlength:"500",placeholder:"Описания...","onUpdate:modelValue":e[2]||(e[2]=s=>n.value=s)},null,2),[[f,n.value]]),a("b",null,U(n.value.length)+"/500",1)]),a("div",H,[u.value?(b(),h("input",{key:0,type:"submit",value:"Добавить",disabled:!l.value||!o.value||!n.value,class:i({"disabled-input":!l.value||!o.value||!n.value})},null,10,Y)):k("",!0),u.value?k("",!0):(b(),h("button",J,e[4]||(e[4]=[a("div",{class:"loader"},null,-1)])))])],32)]))}};export{Q as default};
